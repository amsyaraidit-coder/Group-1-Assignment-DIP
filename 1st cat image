#1st cat
import numpy as np
import matplotlib.pyplot as plt
from PIL import Image
# We use scipy.ndimage for basic morphology, which is standard in Spyder/Anaconda
from scipy.ndimage import binary_opening

# --- 1. Setup & Loading ---
# IMPORTANT: Replace with the actual path to your image
image_path = r"C:\\Users\\Asus\\Downloads\\cattttt.jpeg"  # <--- Update this path!

try:
    img = Image.open(image_path)
    img_array = np.array(img)

    # Extract color channels as integers for robust calculations
    red = img_array[:, :, 0].astype(int)
    green = img_array[:, :, 1].astype(int)
    blue = img_array[:, :, 2].astype(int)

    # --- 2. Step 1: Initial Color Segmentation ---
    # Goal: Separate foreground (cat + daisies) from background (grass).
    # Logic: Grass is defined by Green being significantly brighter than Red and Blue.
    # We use a multiplier (1.1) to be strict about what counts as "grass".
    is_grass = (green > red * 1.1) & (green > blue * 1.1)
    
    # The initial mask is everything that is NOT grass.
    # This captures the cat AND the daisies.
    initial_mask = np.logical_not(is_grass)

    # --- 3. Step 2: Morphological Cleanup (Removing Daisies) ---
    # Goal: Remove small specks (daisies) and keep the large object (cat).
    # We use an "opening" operation (erosion followed by dilation).
    
    # Define a "kernel" (structure element). This determines the size of objects to remove.
    # A square of 11x11 pixels is larger than most daisies in the image.
    kernel_size = 11
    structure = np.ones((kernel_size, kernel_size))
    
    # Apply binary opening. The daisies are eroded away, the cat is restored.
    final_mask = binary_opening(initial_mask, structure=structure)

    # --- 4. Apply the Final Mask ---
    # Create a black image
    segmented_cat = np.zeros_like(img_array)
    
    # Copy the original colors only where the final mask is True (the cat)
    segmented_cat[final_mask] = img_array[final_mask]

    # --- 5. Display Results ---
    plt.figure(figsize=(10, 5))

    plt.subplot(1, 2, 1)
    plt.title("Original Image")
    plt.imshow(img_array)
    plt.axis('off')

    plt.subplot(1, 2, 2)
    plt.title("Highlighted Cat")
    plt.imshow(segmented_cat)
    plt.axis('off')

    plt.tight_layout()
    plt.show()

except FileNotFoundError:
    print(f"Error: File not found at {image_path}. Please check the path.")
except Exception as e:
    print(f"An error occurred: {e}")
